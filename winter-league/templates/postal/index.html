{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Competitions{% endblock %}</h1>
  {% if g.user %}
    <a class="action" href="{{ url_for('competition.comp_create') }}">New Competition</a>
  {% endif %}
{% endblock %}

{% block content %}

  {% for competition in data.competitions %}
  {% set num_of_rounds = competition.info.rounds %}
  <div class="card mt-2">
    <div class="card-header">
      <h2 class="display-5">{{competition.info.name}} <small>{{competition.info.season}}</small></h2>
      <span class="float-right"><a href="{{url_for('competition.comp_edit', id=competition.info.id)}}">edit</a></span>
    </div>
    <div class="card-body">
        <table class="table table-responsive table-bordered">
          <thead>
          <tr>
            <th>Name</th>
            {% for round in range(competition.info.rounds) %}
            <th>{{loop.index}}</th>
            {% endfor %}
          </tr>
          </thead>
          <tbody>
            {% for person in competition.team_results %}
              <tr>
                <td>{{person.name}}</td>

                {% for round in range(num_of_rounds) %}
                <td class="record" data-name="{{person.name}}" data-shot-id="{{person.scores[round].score_id if person.scores[round]}}">{{ person.scores[round].est if person.scores[round] in person.scores else '' }}</td>
                {% endfor %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
    </div>
  </div>
  {% else %}
    No data
  {% endfor %}

<!-- The Modal -->
<div class="modal" id="add_score">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title"></h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <!-- Modal body -->
      <form method="post" action="">
      <div class="modal-body">
        <input type="hidden" name="tid" value=""/>
        <div class="form-group">
          <label for="shooter_name">Shooter Name:</label>
          <input class="form-control" type="text" name="shooter_name" id="shooter_name" value=""/>
        </div>
        <div class="form-group">
          <label for="estmiated">Estmiated:</label>
          <input class="form-control" type="text" name="estmiated" id="estmiated" value=""/>
        </div>
        <div class="form-group">
          <label for="actual">Actual:</label>
          <input class="form-control" type="text" name="actual" id="actual" value=""/>
        </div>
        <div class="form-group">
          <label for="date_shot">Date Shot:</label>
          <input class="form-control" type="date" name="date_shot" id="date_shot" value=""/>
        </div>

      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="submit" class="btn btn-success">Add result</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
      </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}